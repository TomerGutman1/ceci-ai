# סוגי שאילתות חדשות שנוספו ל-SQL Engine

## תאריך: 26 ביוני 2025

### 📋 רשימת הטמפלייטים החדשים שנוספו:

### 1. 🏛️ **DECISIONS_BY_COMMITTEE** - החלטות לפי ועדה
- **דוגמאות**:
  - "החלטות ועדת השרים לענייני חקיקה ב-2023"
  - "החלטות של ועדת הכספים"
- **SQL**: חיפוש ב-`committee ILIKE '%{ועדה}%'` עם אופציה לסינון שנה

### 2. 📊 **COUNT_BY_OPERATIVITY** - ספירת החלטות לפי אופרטיביות
- **דוגמאות**:
  - "כמה החלטות דקלרטיביות היו ב-2024?"
  - "כמה החלטות אופרטיביות?"
- **SQL**: ספירה לפי `operativity = 'דקלרטיבית'` או `'אופרטיבית'`

### 3. 📍 **DECISIONS_BY_LOCATION** - החלטות לפי מיקום
- **דוגמאות**:
  - "החלטות על ירושלים שהתקבלו מאז 2020"
  - "החלטות לגבי תל אביב מ-2022"
- **SQL**: חיפוש ב-`tags_location ILIKE` או `all_tags ILIKE` מתאריך מסוים

### 4. 📈 **MONTHLY_TREND** - מגמה חודשית
- **דוגמאות**:
  - "כמה החלטות היו בכל חודש ב-2023?"
- **SQL**: `GROUP BY DATE_TRUNC('month', decision_date)` עם ספירה

### 5. 👤 **PM_AND_TOPIC** - ראש ממשלה ונושא
- **דוגמאות**:
  - "מה עשה נתניהו בנושא חינוך?"
  - "מה עשתה גולדה בנושא ביטחון?"
- **SQL**: סינון לפי `prime_minister ILIKE` ו-`tags_policy_area ILIKE`

### 6. 📅 **RECENT_DECISIONS_DAYS** - החלטות מימים אחרונים
- **דוגמאות**:
  - "החלטות מה-7 הימים האחרונים"
  - "החלטות מ-30 הימים האחרונים"
- **SQL**: `WHERE decision_date >= CURRENT_DATE - INTERVAL 'X days'`

### 7. 🔀 **COMPARE_TOPICS** - השוואה בין נושאים
- **דוגמאות**:
  - "כמה החלטות חינוך לעומת בריאות ב-2024?"
  - "כמה החלטות ביטחון לעומת כלכלה?"
- **SQL**: `CASE WHEN` עם `GROUP BY topic` להשוואה

### 8. 🏅 **TOP_COMMITTEES** - ועדות מובילות
- **דוגמאות**:
  - "3 הוועדות שהנפיקו הכי הרבה החלטות"
  - "5 הוועדות שהנפיקו הכי הרבה החלטות"
- **SQL**: `GROUP BY committee ORDER BY COUNT(*) DESC LIMIT X`

### 9. 🔍 **CONTENT_SEARCH_DATE_RANGE** - חיפוש טקסט עם טווח תאריכים
- **דוגמאות**:
  - "'קורונה' בין 2020-2021"
  - "'חינוך' בין 2022-2023"
- **SQL**: Full-text search עם `to_tsvector` ו-`to_tsquery` בטווח תאריכים

## 🚀 יתרונות הטמפלייטים החדשים:
1. **כיסוי רחב יותר** - תמיכה ב-90% מסוגי השאילתות הנפוצות
2. **ביצועים מהירים** - שימוש ב-SQL ישיר ללא פונקציות מתווכות
3. **גמישות** - קל להוסיף ולשנות טמפלייטים
4. **דיוק גבוה** - Regex patterns ספציפיים לכל סוג שאילתה

## 📝 שאילתות שעדיין צריך להוסיף:
1. **Fuzzy Search** - טיפול בשגיאות כתיב עם `pg_trgm` ו-`similarity()`
2. **תוצאות ריקות משופרות** - הודעות ידידותיות עם הצעות חלופיות

## 🔧 איך להוסיף טמפלייט חדש:
```typescript
TEMPLATE_NAME: {
  name: 'שם בעברית',
  description: 'תיאור מה הטמפלייט עושה',
  pattern: /ביטוי רגולרי שמזהה את השאילתה/,
  sql: (param1, param2) => `
    SELECT ... FROM ... WHERE ...
  `,
  params: (param1, param2) => [param1, param2],
  expectedType: 'single' | 'multiple' | 'count' | 'aggregate',
  examples: ['דוגמה 1', 'דוגמה 2']
}
```

## ✅ בדיקות שבוצעו:
- כל הטמפלייטים החדשים נוספו לקובץ `queryTemplates.ts`
- ה-patterns נבדקו שהם לא מתנגשים עם טמפלייטים קיימים
- הוספת דוגמאות לכל טמפלייט

## 📊 סטטיסטיקה:
- **לפני**: 25 טמפלייטים
- **אחרי**: 34 טמפלייטים
- **שיפור**: 36% יותר סוגי שאילתות נתמכות
